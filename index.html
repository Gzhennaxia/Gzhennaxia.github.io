<!DOCTYPE html>












  


<html class="theme-next mist use-motion" lang="en">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">






  
  
    
    
  <script src="/lib/pace/pace.min.js?v=1.0.2"></script>
  <link href="/lib/pace/pace-theme-minimal.min.css?v=1.0.2" rel="stylesheet">







<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">






















<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=6.6.0" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=6.6.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=6.6.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=6.6.0">


  <link rel="mask-icon" href="/images/logo.svg?v=6.6.0" color="#222">









<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '6.6.0',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":true,"onmobile":false},
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="我和我骄傲的倔强">
<meta property="og:type" content="website">
<meta property="og:title" content="Gzhennaxia">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="Gzhennaxia">
<meta property="og:description" content="我和我骄傲的倔强">
<meta property="og:locale" content="en">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Gzhennaxia">
<meta name="twitter:description" content="我和我骄傲的倔强">






  <link rel="canonical" href="http://yoursite.com/">



<script type="text/javascript" id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>Gzhennaxia</title>
  











  <noscript>
  <style type="text/css">
    .use-motion .motion-element,
    .use-motion .brand,
    .use-motion .menu-item,
    .sidebar-inner,
    .use-motion .post-block,
    .use-motion .pagination,
    .use-motion .comments,
    .use-motion .post-header,
    .use-motion .post-body,
    .use-motion .collection-title { opacity: initial; }

    .use-motion .logo,
    .use-motion .site-title,
    .use-motion .site-subtitle {
      opacity: initial;
      top: initial;
    }

    .use-motion {
      .logo-line-before i { left: initial; }
      .logo-line-after i { right: initial; }
    }
  </style>
</noscript>

</head>

<body itemscope="" itemtype="http://schema.org/WebPage" lang="en">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope="" itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Gzhennaxia</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="Toggle navigation bar">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home menu-item-active">

    
    
    
      
    

    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>Home</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-about">

    
    
    
      
    

    

    <a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i> <br>About</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">

    
    
    
      
    

    

    <a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i> <br>Tags</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">

    
    
    
      
    

    

    <a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i> <br>Categories</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    
    
      
    

    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>Archives</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-schedule">

    
    
    
      
    

    

    <a href="/schedule/" rel="section"><i class="menu-item-icon fa fa-fw fa-calendar"></i> <br>Schedule</a>

  </li>

      
      
    </ul>
  

  
    

  

  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/12/28/Software and Tools/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Gzhennaxia">
      <meta itemprop="description" content="我和我骄傲的倔强">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Gzhennaxia">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2018/12/28/Software and Tools/" class="post-title-link" itemprop="http://yoursite.com/index.html">Software and Tools</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2018-12-28 09:07:40" itemprop="dateCreated datePublished" datetime="2018-12-28T09:07:40+08:00">2018-12-28</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/Software/" itemprop="url" rel="index"><span itemprop="name">Software</span></a></span>

                
                
                  , 
                
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/Software/Tools/" itemprop="url" rel="index"><span itemprop="name">Tools</span></a></span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2018/12/28/Software and Tools/#comments" itemprop="discussionUrl">
                  <span class="post-meta-item-text">Comments: </span> <span class="post-comments-count valine-comment-count" data-xid="/2018/12/28/Software and Tools/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Listary"><a href="#Listary" class="headerlink" title="Listary"></a>Listary</h1><blockquote>
<p>一款非常强大的搜索软件</p>
</blockquote>
<h2 id="配置百度翻译"><a href="#配置百度翻译" class="headerlink" title="配置百度翻译"></a>配置百度翻译</h2><p>设置&gt;关键字&gt;+</p>
<p><img src="https://i.loli.net/2018/12/23/5c1efe97bccec.jpg" alt=""></p>
<p><img src="https://i.loli.net/2018/12/23/5c1efec5efec9.jpg" alt=""></p>
<p>## </p>
<h1 id="GUN-Wget"><a href="#GUN-Wget" class="headerlink" title="GUN Wget"></a>GUN Wget</h1><blockquote>
<p><a href="https://zhuanlan.zhihu.com/p/28826000" target="_blank" rel="noopener">Wget for windows——优雅地实现批量下载</a></p>
</blockquote>
<h1 id="在线验证-yaml-格式"><a href="#在线验证-yaml-格式" class="headerlink" title="在线验证 yaml 格式"></a>在线验证 yaml 格式</h1><p><a href="http://www.yamllint.com/" target="_blank" rel="noopener">YAML Lint</a></p>
<h1 id="Chrome插件"><a href="#Chrome插件" class="headerlink" title="Chrome插件"></a>Chrome插件</h1><h2 id="Clear-Cache"><a href="#Clear-Cache" class="headerlink" title="Clear Cache"></a>Clear Cache</h2><p>Clear your cache and browsing data with a single click of a button.</p>
<h2 id="SMMS"><a href="#SMMS" class="headerlink" title="SMMS"></a>SMMS</h2><blockquote>
<p>一个简单实用的图床插件</p>
</blockquote>
<h2 id="Vimium"><a href="#Vimium" class="headerlink" title="Vimium"></a>Vimium</h2><blockquote>
<p><a href="https://blog.csdn.net/WPwalter/article/details/80933068" target="_blank" rel="noopener">像黑客一样！Chrome 完全键盘操作指南（原生快捷键 + Vimium 插件）</a></p>
</blockquote>
<h2 id="Octotree"><a href="#Octotree" class="headerlink" title="Octotree"></a>Octotree</h2><blockquote>
<p><a href="http://yifeng.studio/2017/09/06/recommended-extension-tools-about-github/" target="_blank" rel="noopener">强力推荐！那些你不能错过的 GitHub 插件和工具</a></p>
</blockquote>
<h2 id="Save-to-Pocket"><a href="#Save-to-Pocket" class="headerlink" title="Save to Pocket"></a>Save to Pocket</h2><blockquote>
<p>The best way to save articles, videos and more</p>
</blockquote>

          
        
      
    </div>

    

    
    
    

    

    
       
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  
  <div>
	
  </div>
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/12/28/Windows/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Gzhennaxia">
      <meta itemprop="description" content="我和我骄傲的倔强">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Gzhennaxia">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2018/12/28/Windows/" class="post-title-link" itemprop="http://yoursite.com/index.html">Windows</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2018-12-28 09:07:40" itemprop="dateCreated datePublished" datetime="2018-12-28T09:07:40+08:00">2018-12-28</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/Windows/" itemprop="url" rel="index"><span itemprop="name">Windows</span></a></span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2018/12/28/Windows/#comments" itemprop="discussionUrl">
                  <span class="post-meta-item-text">Comments: </span> <span class="post-comments-count valine-comment-count" data-xid="/2018/12/28/Windows/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="激活"><a href="#激活" class="headerlink" title="激活"></a>激活</h1><blockquote>
<p><a href="https://blog.csdn.net/AinUser/article/details/79247841" target="_blank" rel="noopener">win10专业版激活方法——亲测可行！！！</a></p>
</blockquote>
<h1 id="快速打开"><a href="#快速打开" class="headerlink" title="快速打开"></a>快速打开</h1><h2 id="控制面板"><a href="#控制面板" class="headerlink" title="控制面板"></a>控制面板</h2><ol>
<li><code>Win + R</code></li>
<li>输入<code>control.exe</code></li>
<li>回车</li>
</ol>
<h2 id="系统属性"><a href="#系统属性" class="headerlink" title="系统属性"></a>系统属性</h2><ol>
<li><code>Win + R</code></li>
<li>输入<code>sysdm.cpl</code></li>
<li>回车</li>
</ol>
<h1 id="自动隐藏任务栏"><a href="#自动隐藏任务栏" class="headerlink" title="自动隐藏任务栏"></a>自动隐藏任务栏</h1><p>设置&gt;任务栏&gt;勾选自动隐藏任务栏</p>
<p><img src="https://i.loli.net/2018/12/23/5c1f24bb8cc78.jpg" alt=""></p>

          
        
      
    </div>

    

    
    
    

    

    
       
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  
  <div>
	
  </div>
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/12/28/hello-world/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Gzhennaxia">
      <meta itemprop="description" content="我和我骄傲的倔强">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Gzhennaxia">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2018/12/28/hello-world/" class="post-title-link" itemprop="http://yoursite.com/index.html">Hello World</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2018-12-28 09:07:40" itemprop="dateCreated datePublished" datetime="2018-12-28T09:07:40+08:00">2018-12-28</time>
            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2018/12/28/hello-world/#comments" itemprop="discussionUrl">
                  <span class="post-meta-item-text">Comments: </span> <span class="post-comments-count valine-comment-count" data-xid="/2018/12/28/hello-world/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Welcome to <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="noopener">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="noopener">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="noopener">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">"My New Post"</span></span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="noopener">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="noopener">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="noopener">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/deployment.html" target="_blank" rel="noopener">Deployment</a></p>

          
        
      
    </div>

    

    
    
    

    

    
       
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  
  <div>
	
  </div>
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/12/28/GitHub Pages+Hexo+NexT/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Gzhennaxia">
      <meta itemprop="description" content="我和我骄傲的倔强">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Gzhennaxia">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2018/12/28/GitHub Pages+Hexo+NexT/" class="post-title-link" itemprop="http://yoursite.com/index.html">GitHub Pages+Hexo+NexT</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2018-12-28 09:07:40" itemprop="dateCreated datePublished" datetime="2018-12-28T09:07:40+08:00">2018-12-28</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/Blog/" itemprop="url" rel="index"><span itemprop="name">Blog</span></a></span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2018/12/28/GitHub Pages+Hexo+NexT/#comments" itemprop="discussionUrl">
                  <span class="post-meta-item-text">Comments: </span> <span class="post-comments-count valine-comment-count" data-xid="/2018/12/28/GitHub Pages+Hexo+NexT/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <blockquote>
<p>环境：</p>
<p>node.js    10.14.2</p>
<p>npm     6.4.1</p>
<p>hexo    3.8.0</p>
<p>NexT    6.6.0</p>
</blockquote>
          <!--noindex-->
          
            <div class="post-button text-center">
              <a class="btn" href="/2018/12/28/GitHub Pages+Hexo+NexT/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
         
          <!--/noindex-->
        
      
    </div>

    

    
    
    

    

    
       
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  
  <div>
	
  </div>
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/12/25/Redis学习笔记/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Gzhennaxia">
      <meta itemprop="description" content="我和我骄傲的倔强">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Gzhennaxia">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2018/12/25/Redis学习笔记/" class="post-title-link" itemprop="http://yoursite.com/index.html">Redis学习笔记</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2018-12-25 23:27:15" itemprop="dateCreated datePublished" datetime="2018-12-25T23:27:15+08:00">2018-12-25</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2018-12-28 09:07:40" itemprop="dateModified" datetime="2018-12-28T09:07:40+08:00">2018-12-28</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/Cache/" itemprop="url" rel="index"><span itemprop="name">Cache</span></a></span>

                
                
                  , 
                
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/Cache/Redis/" itemprop="url" rel="index"><span itemprop="name">Redis</span></a></span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2018/12/25/Redis学习笔记/#comments" itemprop="discussionUrl">
                  <span class="post-meta-item-text">Comments: </span> <span class="post-comments-count valine-comment-count" data-xid="/2018/12/25/Redis学习笔记/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h1><blockquote>
<p><a href="https://github.com/antirez/redis" target="_blank" rel="noopener">Redis-GitHbu</a></p>
</blockquote>
<h2 id="什么是Redis"><a href="#什么是Redis" class="headerlink" title="什么是Redis"></a>什么是Redis</h2><h2 id="有哪些公司在使用Redis"><a href="#有哪些公司在使用Redis" class="headerlink" title="有哪些公司在使用Redis"></a>有哪些公司在使用Redis</h2><p>GitHub, Twitter, Stackoverflow, Alibaba, 百度，微博，美团，搜狐</p>
<h2 id="Redis的八大特性"><a href="#Redis的八大特性" class="headerlink" title="Redis的八大特性"></a>Redis的八大特性</h2><ol>
<li>速度快</li>
<li>支持持久化</li>
<li>存在多种数据结构</li>
<li>支持多种语言</li>
<li>功能丰富</li>
<li>简单（代码量小，使用方便）</li>
<li>主从复制</li>
<li>高可用，分布式</li>
</ol>
<h3 id="速度快"><a href="#速度快" class="headerlink" title="速度快"></a>速度快</h3><p>官方给的指标是10w OPS（每秒十万次读写）</p>
<p>这么快的原因：</p>
<ul>
<li>数据存放在内存中</li>
<li><p>使用C语言编写（大约五万行代码），C语言离操作系统较近</p>
</li>
<li><p>线程模型为单线程</p>
</li>
</ul>
<h3 id="持久化"><a href="#持久化" class="headerlink" title="持久化"></a>持久化</h3><p>Redis所有数据保存在内存中，对数据的更新将异步的保存到磁盘上。</p>
<h3 id="多种数据结构"><a href="#多种数据结构" class="headerlink" title="多种数据结构"></a>多种数据结构</h3><p>五大数据结构：</p>
<ol>
<li>Strings</li>
<li>Hash Tables</li>
<li>Linked Lists</li>
<li>Sets</li>
<li>Sorted Sets</li>
</ol>
<p>其他新结构：</p>
<ol start="6">
<li>BitMaps: 位图（本质是字符串，可以实现类似<a href="https://china.googleblog.com/2007/07/bloom-filter_7469.html" target="_blank" rel="noopener">布隆过滤器</a>的功能）</li>
<li>HyperLogLog：超小内存唯一值计数（本质是字符串）</li>
<li>GEO：地理信息定位（本质是有序集合，Redis-3.2后提供）</li>
</ol>
<h3 id="支持多种客户端语言"><a href="#支持多种客户端语言" class="headerlink" title="支持多种客户端语言"></a>支持多种客户端语言</h3><p>Java，PHP，python，Ruby，Lua，nodejs</p>
<h3 id="功能丰富"><a href="#功能丰富" class="headerlink" title="功能丰富"></a>功能丰富</h3><ol>
<li>发布订阅模式</li>
<li>Lua脚本</li>
<li>事务</li>
<li>pipeline（提高客户端并发效率）</li>
</ol>
<h2 id="典型应用场景"><a href="#典型应用场景" class="headerlink" title="典型应用场景"></a>典型应用场景</h2><ul>
<li>缓存系统</li>
<li>计数器（微博的转发数，评论数以及视频网站的播放数等）</li>
<li>消息队列系统 </li>
<li>排行榜</li>
<li>社交网络（粉丝数，关注数，共同关注数）</li>
<li>实时系统（垃圾邮件处理系统，布隆过滤器）</li>
</ul>
<h1 id="安装Redis"><a href="#安装Redis" class="headerlink" title="安装Redis"></a>安装Redis</h1><h2 id="Redis安装"><a href="#Redis安装" class="headerlink" title="Redis安装"></a>Redis安装</h2><h3 id="Linux系统下安装Redis"><a href="#Linux系统下安装Redis" class="headerlink" title="Linux系统下安装Redis"></a>Linux系统下安装Redis</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 1. 下载</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> wget http://download.redis.io/releases/redis-5.0.3.tar.gz</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 2. 解压缩</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> tar xzf redis-5.0.3.tar.gz</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 3. 建立一个软连接</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> In -s redis-5.0.3 redis</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">cd</span> redis-5.0.3</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 4. 编译</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> make</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 5. 安装</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> make install</span></span><br></pre></td></tr></table></figure>
<h2 id="可执行文件说明"><a href="#可执行文件说明" class="headerlink" title="可执行文件说明"></a>可执行文件说明</h2><table>
<thead>
<tr>
<th>可执行文件</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>redis-server</td>
<td>Redis服务器</td>
</tr>
<tr>
<td>redis-cli</td>
<td>Redis命令行客户端</td>
</tr>
<tr>
<td>redis-benchmark</td>
<td>Redis性能测试工具</td>
</tr>
<tr>
<td>redis-check-aof</td>
<td>AOF文件修复工具</td>
</tr>
<tr>
<td>redis-check-dump</td>
<td>RDB文件修复工具</td>
</tr>
<tr>
<td>redis-sentinel</td>
<td>Sentinel服务器（2.8以后）</td>
</tr>
</tbody>
</table>
<h2 id="三种启动方法"><a href="#三种启动方法" class="headerlink" title="三种启动方法"></a>三种启动方法</h2><h3 id="最简启动"><a href="#最简启动" class="headerlink" title="最简启动"></a>最简启动</h3><p>直接使用<code>redis-server</code></p>
<h3 id="动态参数启动"><a href="#动态参数启动" class="headerlink" title="动态参数启动"></a>动态参数启动</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">redis-server --port 6380 # 默认端口是6379</span><br></pre></td></tr></table></figure>
<h3 id="配置文件启动"><a href="#配置文件启动" class="headerlink" title="配置文件启动"></a>配置文件启动</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">redis-server configPath</span><br></pre></td></tr></table></figure>
<h3 id="验证方法"><a href="#验证方法" class="headerlink" title="验证方法"></a>验证方法</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ps -ef|grep redis</span><br><span class="line">netstat -antpl|grep redis</span><br><span class="line">redis-cli -h ip -p port ping</span><br></pre></td></tr></table></figure>
<h3 id="比较"><a href="#比较" class="headerlink" title="比较"></a>比较</h3><ul>
<li>生产环境推荐配置启动</li>
<li>单机多实例配置文件可以用端口区分开</li>
</ul>
<h2 id="简单的客户端连接"><a href="#简单的客户端连接" class="headerlink" title="简单的客户端连接"></a>简单的客户端连接</h2><h3 id="连接"><a href="#连接" class="headerlink" title="连接"></a>连接</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">redis-cli -h 10.10.79.150 -p 6384</span><br><span class="line">ping</span><br><span class="line">set hello world</span><br><span class="line">get hello</span><br></pre></td></tr></table></figure>
<h3 id="返回值"><a href="#返回值" class="headerlink" title="返回值"></a>返回值</h3><ol>
<li>状态回复（如<code>ping</code>返回<code>PONG</code>）</li>
<li>错误回复（如<code>(error) WRONGTYPE Operation against</code>）</li>
<li>整数回复（如<code>incr hello</code>回复<code>(integer) 1</code>）</li>
<li>字符串回复（如<code>get hello</code>回复<code>&quot;world&quot;</code>）</li>
<li>多行字符串回复（如<code>mget hello foo</code>返回<code>&quot;world&quot; &quot;bar&quot;</code>）</li>
</ol>
<h2 id="Redis常用配置"><a href="#Redis常用配置" class="headerlink" title="Redis常用配置"></a>Redis常用配置</h2><table>
<thead>
<tr>
<th>属性</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>daemonize</td>
<td>是否是守护进程（no默认\</td>
<td>yes推荐）</td>
</tr>
<tr>
<td>port</td>
<td>Redis对外端口号，默认为6379<br>7379对应手机按键上MERZ对应的号码，MERZ取自意大利歌女Alessia Merz的名字</td>
</tr>
<tr>
<td>logfile</td>
<td>Redis系统日志</td>
</tr>
<tr>
<td>dir</td>
<td>Redis工作目录</td>
</tr>
</tbody>
</table>
<h1 id="Redis-API"><a href="#Redis-API" class="headerlink" title="Redis API"></a>Redis API</h1><h2 id="通用命令"><a href="#通用命令" class="headerlink" title="通用命令"></a>通用命令</h2><ol>
<li><p>keys</p>
<p>eg：<code>keys *</code> 遍历所有的key</p>
<p>怎么用：</p>
<p>​    热备从节点</p>
<p>​    scan</p>
</li>
<li><p>dbsize</p>
<p>计算key的总数</p>
</li>
<li><p>exists key</p>
<p>检查key是否存在，存在返回1，否则返回0</p>
</li>
<li><p>del key [key …]</p>
<p>删除指定key-value，成功返回1，否则返回0</p>
</li>
<li><p>expire key seconds</p>
<p><code>ttl key</code>查看key剩余的过期时间</p>
<p><code>persist key</code>去掉key的过期时间</p>
</li>
<li><p>type key</p>
<p>返回key的类型（string，hash，list，set，zset，none）</p>
</li>
</ol>
<table>
<thead>
<tr>
<th>命令</th>
<th>时间复杂度</th>
</tr>
</thead>
<tbody>
<tr>
<td>keys</td>
<td>O(n)</td>
</tr>
<tr>
<td>dbsize</td>
<td>O(1)</td>
</tr>
<tr>
<td>del</td>
<td>O(1)</td>
</tr>
<tr>
<td>exists</td>
<td>O(1)</td>
</tr>
<tr>
<td>expire</td>
<td>O(1)</td>
</tr>
<tr>
<td>type</td>
<td>O(1)</td>
</tr>
</tbody>
</table>
<h2 id="数据结构和内部编码"><a href="#数据结构和内部编码" class="headerlink" title="数据结构和内部编码"></a>数据结构和内部编码</h2><h3 id="内部编码"><a href="#内部编码" class="headerlink" title="内部编码"></a>内部编码</h3><p><img src="https://i.loli.net/2018/12/25/5c2240654f22b.png" alt="Redis 内部编码"></p>
<h3 id="字符串键值结构"><a href="#字符串键值结构" class="headerlink" title="字符串键值结构"></a>字符串键值结构</h3><table>
<thead>
<tr>
<th>key</th>
<th>value</th>
</tr>
</thead>
<tbody>
<tr>
<td>hello</td>
<td>world</td>
</tr>
<tr>
<td>counter</td>
<td>1</td>
</tr>
<tr>
<td>bits</td>
<td>\</td>
<td>1\</td>
<td>0\</td>
<td>1\</td>
<td>1\</td>
<td>1\</td>
<td>0\</td>
<td>1\</td>
<td></td>
</tr>
<tr>
<td></td>
<td>{<br>“prodduct”:{<br>“id”: “3242”<br>“name”: “test423”<br>}<br>}</td>
</tr>
</tbody>
</table>
<p>Value up to 512MB，up to 100k is recommended</p>
<h4 id="场景"><a href="#场景" class="headerlink" title="场景"></a>场景</h4><ul>
<li>缓存</li>
<li>计数器</li>
<li>分布式锁</li>
</ul>
<h4 id="命令"><a href="#命令" class="headerlink" title="命令"></a>命令</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 1. 获取key对应的value O(1)</span></span><br><span class="line">get key</span><br><span class="line"><span class="meta">#</span><span class="bash"> 2. 设置key-value O(1)</span></span><br><span class="line">set key value</span><br><span class="line"><span class="meta">#</span><span class="bash"> 3. 删除key-value O(1)</span></span><br><span class="line">del key</span><br></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 1. key自增1，如果key不存在，自增后get（key）=1 O(1)</span></span><br><span class="line">incr key</span><br><span class="line"><span class="meta">#</span><span class="bash"> 2. key自减1，如果key不存在，自减后get（key）=-1 O(1)</span></span><br><span class="line">decr key</span><br><span class="line"><span class="meta">#</span><span class="bash"> 3. key自增k，如果key不存在，自增后get（key）=k O(1)</span></span><br><span class="line">incrby key k</span><br><span class="line"><span class="meta">#</span><span class="bash"> 4. key自减k，如果key不存在，自减后get（key）=-k O(1)</span></span><br><span class="line">decrby key k</span><br></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 1. 不管key是否存在，都设置 O(1)</span></span><br><span class="line">set key value</span><br><span class="line"><span class="meta">#</span><span class="bash"> 2. key不存在，才设置 O(1)</span></span><br><span class="line">setnx key value</span><br><span class="line"><span class="meta">#</span><span class="bash"> 3. key存在，才设置 O(1)</span></span><br><span class="line">set key value xx</span><br></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 1. 批量获取key，原子操作 O(n)</span></span><br><span class="line">mget key1 key2 key3...</span><br><span class="line"><span class="meta">#</span><span class="bash"> 2. 批量设置key-value O(n)</span></span><br><span class="line">mset key1 value1 key2 vlaue2 key3 value3</span><br></pre></td></tr></table></figure>
<p>n次get = n次网络时间 + n次命令时间</p>
<p>1次mget = 1次网络时间 + n次命令时间</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 1. <span class="built_in">set</span> key newvalue并返回旧的value O(1)</span></span><br><span class="line">getset key newvalue</span><br><span class="line"><span class="meta">#</span><span class="bash"> 2. 将value追加到旧的value O(1)</span></span><br><span class="line">append key value</span><br><span class="line"><span class="meta">#</span><span class="bash"> 3. 返回字符串的长度（注意中文） O(1)</span></span><br><span class="line">strlen key</span><br></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 1. 增加key对应的值3.5 O(1)</span></span><br><span class="line">incrbyfloat key 3.5</span><br><span class="line"><span class="meta">#</span><span class="bash"> 2. 获取字符串指定下标范围内的值 O(1)</span></span><br><span class="line">getrange key start end</span><br><span class="line"><span class="meta">#</span><span class="bash"> 3. 设置指定下标范围内对应的值 O(1)</span></span><br><span class="line">setrange key index value</span><br></pre></td></tr></table></figure>
<h5 id="复杂度总结"><a href="#复杂度总结" class="headerlink" title="复杂度总结"></a>复杂度总结</h5><table>
<thead>
<tr>
<th>命令</th>
<th>含义</th>
<th>复杂度</th>
</tr>
</thead>
<tbody>
<tr>
<td>set key value</td>
<td>是指key-value</td>
<td>O(1)</td>
</tr>
<tr>
<td>get key</td>
<td>获取key-value</td>
<td>O(1)</td>
</tr>
<tr>
<td>del key</td>
<td>删除key-value</td>
<td>O(1)</td>
</tr>
<tr>
<td>setnx setxx</td>
<td>根据key是否存在设置key-value</td>
<td>O(1)</td>
</tr>
<tr>
<td>Incr decr</td>
<td>计数</td>
<td>O(1)</td>
</tr>
<tr>
<td>mget mset</td>
<td>批量操作key-value</td>
<td>O(n)</td>
</tr>
</tbody>
</table>
<h4 id="实战"><a href="#实战" class="headerlink" title="实战"></a>实战</h4><ol>
<li><p>记录网站每个用户个人主页的访问量？</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">incr userid:pageview</span><br></pre></td></tr></table></figure>
</li>
<li><p>缓存视频的基本信息（数据源在MySQL中）伪代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> VideoInfo <span class="title">get</span><span class="params">(<span class="keyword">long</span> id)</span></span>&#123;</span><br><span class="line">    String redisKey = redisPrefix + id;</span><br><span class="line">    VideoInfo videoInfo = redis.get(redisKey);</span><br><span class="line">    <span class="keyword">if</span>(videoInfo == <span class="keyword">null</span>)&#123;</span><br><span class="line">        videoInfo = mysql.get(id);</span><br><span class="line">        <span class="keyword">if</span>(videoInfo != <span class="keyword">null</span>)&#123;</span><br><span class="line">            <span class="comment">//序列化</span></span><br><span class="line">            redis.set(redisKey, serialize(videoInfo));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> videoInfo;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>分布式计数器</p>
<p>incr id (原子操作)</p>
</li>
</ol>
<h3 id="Hash键值结构"><a href="#Hash键值结构" class="headerlink" title="Hash键值结构"></a>Hash键值结构</h3><table>
<thead>
<tr>
<th>key</th>
<th>field</th>
<th>value</th>
</tr>
</thead>
<tbody>
<tr>
<td>user:1:info</td>
<td>name<br>age<br>Date</td>
<td>Ronaldo<br>32<br>239</td>
</tr>
</tbody>
</table>
<h4 id="特点"><a href="#特点" class="headerlink" title="特点"></a>特点</h4><ol>
<li><p>是一个<code>value</code>为<code>Map</code>的<code>Map</code></p>
</li>
<li><p><code>field</code>不能相同，<code>value</code>可以相同</p>
</li>
</ol>
<h4 id="API"><a href="#API" class="headerlink" title="API"></a>API</h4><p>所有以哈希为结构的命令都是以<code>H</code>开头的。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 1. 获取<span class="built_in">hash</span> key对应的field的value O(1)</span></span><br><span class="line">hget key field</span><br><span class="line"><span class="meta">#</span><span class="bash"> 2. 设置<span class="built_in">hash</span> key对应field的value O(1)</span></span><br><span class="line">hset key field value</span><br><span class="line"><span class="meta">#</span><span class="bash"> 3. 删除<span class="built_in">hash</span> key对应field的value O(1)</span></span><br><span class="line">hdel key field</span><br></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 1. 判断<span class="built_in">hash</span> key是否有field O(1)</span></span><br><span class="line">hexists key field</span><br><span class="line"><span class="meta">#</span><span class="bash"> 2. 获取<span class="built_in">hash</span> key field的数量 O(1)</span></span><br><span class="line">hlen key</span><br></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 1. 批量获取<span class="built_in">hash</span> key的一批field对应的值 O(n)</span></span><br><span class="line">hmget key field1 field2... fieldN</span><br><span class="line"><span class="meta">#</span><span class="bash"> 2. 批量设置<span class="built_in">hash</span> key的一批field value O(n)</span></span><br><span class="line">hmset key field1 value1 field2 value2...fieldN valueN</span><br></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 1. 返回<span class="built_in">hash</span> key对应所有的field和value O(n)</span></span><br><span class="line">hgetall key</span><br><span class="line"><span class="meta">#</span><span class="bash"> 2. 返回<span class="built_in">hash</span> key对应所有field的value O(n)</span></span><br><span class="line">hvals key</span><br><span class="line"><span class="meta">#</span><span class="bash"> 3. 返回<span class="built_in">hash</span> key对应多有field O(n)</span></span><br><span class="line">hkeys key</span><br></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 1. 设置<span class="built_in">hash</span> key对应field的value（若field已存在，则失败） O(1)</span></span><br><span class="line">hsetnx key field value</span><br><span class="line"><span class="meta">#</span><span class="bash"> 2. <span class="built_in">hash</span> key对应的filed的value自增intCounter O(1)</span></span><br><span class="line">hincrby key field intCounter</span><br><span class="line"><span class="meta">#</span><span class="bash"> 3. hincrby浮点数版 O(1)</span></span><br><span class="line">hincrbyfloat key field floatCounter</span><br></pre></td></tr></table></figure>
<h5 id="复杂度总结-1"><a href="#复杂度总结-1" class="headerlink" title="复杂度总结"></a>复杂度总结</h5><table>
<thead>
<tr>
<th>命令</th>
<th>复杂度</th>
</tr>
</thead>
<tbody>
<tr>
<td>hget hset hdel</td>
<td>O(1)</td>
</tr>
<tr>
<td>hexists</td>
<td>O(1)</td>
</tr>
<tr>
<td>hincrby</td>
<td>O(1)</td>
</tr>
<tr>
<td>hgetall hvals hkeys</td>
<td>O(n)</td>
</tr>
<tr>
<td>hmget hmset</td>
<td>O(n)</td>
</tr>
</tbody>
</table>
<h3 id="列表"><a href="#列表" class="headerlink" title="列表"></a>列表</h3><h4 id="特点-1"><a href="#特点-1" class="headerlink" title="特点"></a>特点</h4><ol>
<li>有序（根据插入顺序得到遍历顺序）</li>
<li>可以重复</li>
<li>左右两边都可以插入和弹出</li>
</ol>
<h4 id="API-1"><a href="#API-1" class="headerlink" title="API"></a>API</h4><p>列表的API都以<code>L</code>开头</p>
<h5 id="增"><a href="#增" class="headerlink" title="增"></a>增</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 1. 从列表右端插入值 O(1)</span></span><br><span class="line">rpush key value1 value2 ... valueN</span><br><span class="line"><span class="meta">#</span><span class="bash"> 2. 从列表左端插入值 O(1)</span></span><br><span class="line">lpush key value1 value2 ... valueN</span><br><span class="line"><span class="meta">#</span><span class="bash"> 3. 在list指定的值前|后插入newValue O(n)</span></span><br><span class="line">linsert key before|after value newValue</span><br></pre></td></tr></table></figure>
<h5 id="删"><a href="#删" class="headerlink" title="删"></a>删</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 1. 从列表左侧弹出一个item O(1)</span></span><br><span class="line">lpop key</span><br><span class="line"><span class="meta">#</span><span class="bash"> 2. 从列表右侧弹出一个item O(1)</span></span><br><span class="line">rpop key</span><br></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 3. 根据count值，从列表中删除所有value相等的项 O(n)</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> （1）count&gt;0，从左到右，删除最多count个value相等的项</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> （2）count&lt;0，从右到左，删除最多Math。abs（count）个value相等的项</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> （3）count=0，删除所有value相等的项</span></span><br><span class="line">lrem key count value</span><br></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 4. 按照索引范围修剪列表 O(n)</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 	 如ltrime listkey 1 4 是指删除除了下标为1-4（包括1和4）其他项</span></span><br><span class="line">ltrim key start end</span><br></pre></td></tr></table></figure>
<h5 id="查"><a href="#查" class="headerlink" title="查"></a>查</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 1. 获取列表指定索引范围所有item O(n)</span></span><br><span class="line"><span class="meta">#</span><span class="bash">  	 如lrange listKey 0 2获取的是下标0-2（包括0和2）的项</span></span><br><span class="line"><span class="meta">#</span><span class="bash">  	 再如lrange listKey 1 -1获取的是下标1-（len-1）的项</span></span><br><span class="line">lrange key start end</span><br></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 2. 获取列表指定索引的item O(n)</span></span><br><span class="line"><span class="meta">#</span><span class="bash">    如lindex listkye -1 取到的是最后一个元素</span></span><br><span class="line">lindex key index</span><br></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 3. 获取列表长度 O(1)</span></span><br><span class="line">llen key</span><br></pre></td></tr></table></figure>
<h5 id="改"><a href="#改" class="headerlink" title="改"></a>改</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 1. 设置列表指定索引值为newValue O(n)</span></span><br><span class="line">lset key index newValue</span><br></pre></td></tr></table></figure>
<h5 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 1. lpop阻塞版本，timeout是阻塞超时时间，timeout=0为永远不阻塞 O(1)</span></span><br><span class="line">blpop key timeout</span><br><span class="line"><span class="meta">#</span><span class="bash"> 2. rpop阻塞版本，timeout是阻塞超时时间，timeout=0为永远不阻塞 O(1)</span></span><br><span class="line">brpop key timeout</span><br></pre></td></tr></table></figure>
<h5 id="TIPS"><a href="#TIPS" class="headerlink" title="TIPS"></a>TIPS</h5><ol>
<li>LPUSH + LPOP = Stack</li>
<li>LPUSH + RPOP = Queue</li>
<li>LPUSH + LTRIM = Capped Collection</li>
<li>LPUSH + BRPOP = Message Queue</li>
</ol>
<h4 id="实战-1"><a href="#实战-1" class="headerlink" title="实战"></a>实战</h4><ol>
<li>TimeLine</li>
</ol>
<h4 id="实战-2"><a href="#实战-2" class="headerlink" title="实战"></a>实战</h4><ol>
<li><p>记录网站每个用户个人主页的访问量</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hincrby user:1:info pageview count</span><br></pre></td></tr></table></figure>
</li>
<li><p>缓存视频的基本信息（数据源在mysql中）伪代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> VideoInfo <span class="title">get</span><span class="params">(<span class="keyword">long</span> id)</span></span>&#123;</span><br><span class="line">    String redisKey = redisPrefix + id;</span><br><span class="line">    Map&lt;String, String&gt; hashMap = redis.hgetAll(redisKey);</span><br><span class="line">    VideoInfo videoInfo = transferMapToVideo(hashMap);</span><br><span class="line">    <span class="keyword">if</span>(videoInfo == <span class="keyword">null</span>)&#123;</span><br><span class="line">        videoInfo = mysql.get(id);</span><br><span class="line">        <span class="keyword">if</span>(videoInfo != <span class="keyword">null</span>)&#123;</span><br><span class="line">            redis.hmset(redisKey, transferVideoToMap(videoInfo));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> videoInfo;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="单线程架构"><a href="#单线程架构" class="headerlink" title="单线程架构"></a>单线程架构</h2><p>Redis在同一时刻只会执行一条命令</p>
<h3 id="单线程为什么这么快"><a href="#单线程为什么这么快" class="headerlink" title="单线程为什么这么快"></a>单线程为什么这么快</h3><ol>
<li><p>纯内存</p>
</li>
<li><p>非阻塞IO</p>
</li>
<li><p>避免线程切换和竞态消耗</p>
</li>
<li><p>拒绝长（慢）命令</p>
<p>​    keys, flushall, flushdb, slow lua script, mutil/exec, operate big value(collection)</p>
</li>
<li><p>其实不是单线程</p>
<p>fysnc file descriptor</p>
<p>close file descriptor</p>
</li>
</ol>
<h1 id="Redis客户端"><a href="#Redis客户端" class="headerlink" title="Redis客户端"></a>Redis客户端</h1><h2 id="Java客户端：Jedis"><a href="#Java客户端：Jedis" class="headerlink" title="Java客户端：Jedis"></a>Java客户端：Jedis</h2><h3 id="获取Jedis"><a href="#获取Jedis" class="headerlink" title="获取Jedis"></a>获取Jedis</h3><ol>
<li>添加<code>Maven</code>依赖</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- https://mvnrepository.com/artifact/redis.clients/jedis --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>redis.clients<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jedis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.9.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ol start="2">
<li><p>Jedis直连（TCP连接）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Jedis jedis = <span class="keyword">new</span> Jedis(<span class="string">"127.0.0.1"</span>, <span class="number">6379</span>);</span><br><span class="line">jedis.set(<span class="string">"hello"</span>,<span class="string">"world"</span>);</span><br><span class="line">String value = jedis.get(<span class="string">"hello"</span>);</span><br></pre></td></tr></table></figure>
<p><code>Jedis(String host, int port, int connectionTimeout, int soTimeout)</code></p>
<ul>
<li>host : Redis节点所在机器的IP</li>
<li>port : Redis节点的端口</li>
<li>connectionTimeout : 客户端连接超时时间（内部使用socket技术）</li>
<li>soTimeout : 客户端读写超时时间</li>
</ul>
</li>
</ol>
<h3 id="Jedis基本使用"><a href="#Jedis基本使用" class="headerlink" title="Jedis基本使用"></a>Jedis基本使用</h3><h3 id="Jedis连接池使用"><a href="#Jedis连接池使用" class="headerlink" title="Jedis连接池使用"></a>Jedis连接池使用</h3><h4 id="简单使用"><a href="#简单使用" class="headerlink" title="简单使用"></a>简单使用</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 初始化Jedis连接池，通常来讲JedisPool是单例的。</span></span><br><span class="line">GenericObjectPoolConfig poolConfig = <span class="keyword">new</span> GenericObjectPoolConfig();</span><br><span class="line">JedisPool jedisPool = <span class="keyword">new</span> JedisPool(poolConfig, <span class="string">"127.0.0.1"</span>, <span class="number">6379</span>);</span><br><span class="line"></span><br><span class="line">Jedis jedis = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line">    <span class="comment">// 1. 从连接池获取jedis对象</span></span><br><span class="line">    jedis = jedisPool.getResource();</span><br><span class="line">    <span class="comment">// 2. 执行操作</span></span><br><span class="line">    jedis.set(<span class="string">"hello"</span>, <span class="string">"world"</span>);</span><br><span class="line">&#125; <span class="keyword">catch</span> (Exception e)&#123;</span><br><span class="line">    e.printStackTrance();</span><br><span class="line">&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">    <span class="keyword">if</span>(jedis != <span class="keyword">null</span>)&#123;</span><br><span class="line">        <span class="comment">// 如果使用JedisPool，close操作不是关闭连接，二十代表归还连接池。</span></span><br><span class="line">        jedis.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th></th>
<th>优点</th>
<th>缺点</th>
</tr>
</thead>
<tbody>
<tr>
<td>直连</td>
<td>- 简单方便<br>- 适用于少量长期连接的场景</td>
<td>- 存在每次新建/关闭TCP开销<br>- 资源无法控制，存在连接泄露的可能<br>- Jedis对象线程不安全</td>
</tr>
<tr>
<td>连接池</td>
<td>- Jedis预先生成，降低开销使用<br>- 连接池的形式保护和控制资源的使用</td>
<td>相对于直连，使用相对麻烦，尤其在资源的管理上需要很多参数来保证，一旦规划不合理也会出现问题。</td>
</tr>
</tbody>
</table>
<h2 id="python客户端：redis-py"><a href="#python客户端：redis-py" class="headerlink" title="python客户端：redis-py"></a>python客户端：redis-py</h2><h3 id="源码安装"><a href="#源码安装" class="headerlink" title="源码安装"></a>源码安装</h3><blockquote>
<p><a href="https://redis.io/clients#python" target="_blank" rel="noopener">Redis-clients-python</a></p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">wget https://github.com/andymccurdy/redis-py/archive/3.0.0.zip</span><br><span class="line">unzip redis-3.0.0.zip</span><br><span class="line">cd redis-3.0.0</span><br><span class="line"><span class="meta">#</span><span class="bash"> 安装redis-py</span></span><br><span class="line">sudo python setup.py install</span><br></pre></td></tr></table></figure>
<h3 id="简单使用-1"><a href="#简单使用-1" class="headerlink" title="简单使用"></a>简单使用</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> redis</span><br><span class="line">client = redis.StrictRedis(host=<span class="string">'127.0.0.1'</span>, port=<span class="number">6379</span>)</span><br><span class="line">key = <span class="string">"hello"</span></span><br><span class="line">setResult = client.set(key, <span class="string">"python-redis"</span>)</span><br><span class="line"><span class="keyword">print</span> setResult</span><br><span class="line">value = client.get(key)</span><br><span class="line"><span class="keyword">print</span> <span class="string">"key:"</span> + key + <span class="string">", value:"</span> + value</span><br></pre></td></tr></table></figure>
<h2 id="Go客户端"><a href="#Go客户端" class="headerlink" title="Go客户端"></a>Go客户端</h2> <figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">c,err := redis.Dial(<span class="string">"tcp"</span>, <span class="string">"127.0.0.1:6379"</span>)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span>&#123;</span><br><span class="line">    fmt.Println(err)</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">defer</span> c.Close()</span><br><span class="line">v, err := c.Do(<span class="string">"SET"</span>, <span class="string">"hello"</span>, <span class="string">"world"</span>)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span>&#123;</span><br><span class="line">    fmt.Println(err)</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line">fmt.Println(v)</span><br><span class="line">v, err = redis.String(c.Do(<span class="string">"GET"</span>, <span class="string">"hello"</span>))</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">    fmt.Println(err)</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="瑞士军刀Redis"><a href="#瑞士军刀Redis" class="headerlink" title="瑞士军刀Redis"></a>瑞士军刀Redis</h1><h2 id="慢查询"><a href="#慢查询" class="headerlink" title="慢查询"></a>慢查询</h2><h3 id="生命周期"><a href="#生命周期" class="headerlink" title="生命周期"></a>生命周期</h3><p><img src="https://i.loli.net/2018/12/27/5c2419d644e00.png" alt=""></p>
<ol>
<li>慢查询发生在第三阶段</li>
<li>客户端超时不一定是慢查询导致的，慢查询只是导致客户端超时的一个可能因素</li>
</ol>
<h3 id="两个配置"><a href="#两个配置" class="headerlink" title="两个配置"></a>两个配置</h3><h4 id="slowlog-max-len"><a href="#slowlog-max-len" class="headerlink" title="slowlog-max-len"></a>slowlog-max-len</h4><ol>
<li>先进先出队列</li>
<li>固定长度</li>
<li>保存在内存内</li>
</ol>
<h4 id="slowlog-log-slower-than"><a href="#slowlog-log-slower-than" class="headerlink" title="slowlog-log-slower-than"></a>slowlog-log-slower-than</h4><ol>
<li>慢查询阈值（单位：微妙，1毫秒等于1000微秒）</li>
<li>slowlog-log-slower-than=0，记录所有命令</li>
<li>slowlog-log-slower-than&lt;0，不记录任何命令</li>
</ol>
<h4 id="配置方法"><a href="#配置方法" class="headerlink" title="配置方法"></a>配置方法</h4><ol>
<li>默认值<ul>
<li>config get slowlog-max-len = 128</li>
<li>config get slowlog-log-slower-than = 10000</li>
</ul>
</li>
<li>修改配置文件后重启（适用于未启动时）</li>
<li>动态配置<ul>
<li>config set slowlog-max-len 1000</li>
<li>config set slowlog-log-slower-than 1000</li>
</ul>
</li>
</ol>
<h3 id="三个命令"><a href="#三个命令" class="headerlink" title="三个命令"></a>三个命令</h3><ol>
<li>slowlog get [n] ：获取慢查询队列</li>
<li>slowlog len ：获取慢查询队列长度</li>
<li>slowlog reset ：清空慢查询队列</li>
</ol>
<h3 id="运维经验"><a href="#运维经验" class="headerlink" title="运维经验"></a>运维经验</h3><ol>
<li>slowlog-max-len不要是指过大，默认10ms，通常是指1ms</li>
<li>slowlog-log-slower-than不要设置太小，通常设置1000左右</li>
<li>理解命令生命周期</li>
<li>定期持久化慢查询</li>
</ol>
<h2 id="pipeline"><a href="#pipeline" class="headerlink" title="pipeline"></a>pipeline</h2><h3 id="什么是流水线"><a href="#什么是流水线" class="headerlink" title="什么是流水线"></a>什么是流水线</h3><p>流水线就是一次网络连接里传输一批命令，节省网络传输时间</p>
<table>
<thead>
<tr>
<th>命令</th>
<th>N个命令操作</th>
<th>1次pipeline</th>
</tr>
</thead>
<tbody>
<tr>
<td>时间</td>
<td>n次网络 + n次命令</td>
<td>1次网络 + n次命令</td>
</tr>
<tr>
<td>数据量</td>
<td>1条命令</td>
<td>n条命令</td>
</tr>
</tbody>
</table>
<p>注意：</p>
<ol>
<li>Redis的命令时间是微秒级别。</li>
<li>pipeline每次条数要控制（网络）。</li>
</ol>
<h3 id="客户端实现-pipeline-Jedis"><a href="#客户端实现-pipeline-Jedis" class="headerlink" title="客户端实现 pipeline-Jedis"></a>客户端实现 pipeline-Jedis</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// before pipeline</span></span><br><span class="line">Jedis jedis = <span class="keyword">new</span> jedis(<span class="string">"127.0.0.1"</span>, <span class="number">6379</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10000</span>; i++)&#123;</span><br><span class="line">    jedis.hset(<span class="string">"hashkey:"</span> + i, <span class="string">"field"</span> + i, <span class="string">"value"</span> + i);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// after pipeline</span></span><br><span class="line">Jedis jedis = <span class="keyword">new</span> jedis(<span class="string">"127.0.0.1"</span>, <span class="number">6379</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">100</span>; i++)&#123;</span><br><span class="line">    Pipeline pipeline = jedis.pipelined();</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> j = i*<span class="number">100</span>; j &lt; (i+<span class="number">1</span>)*<span class="number">100</span>; j++)&#123;</span><br><span class="line">        pipeline.hset(<span class="string">"hashkey:"</span> + j, <span class="string">"field"</span> + j, <span class="string">"value"</span> + j);</span><br><span class="line">    &#125;</span><br><span class="line">    pipeline.syncAndReturnAll();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="与原生M操作做对比"><a href="#与原生M操作做对比" class="headerlink" title="与原生M操作做对比"></a>与原生M操作做对比</h3><p>M操作是原子操作，pipeline是非原子操作。</p>
<h3 id="使用建议"><a href="#使用建议" class="headerlink" title="使用建议"></a>使用建议</h3><ol>
<li>注意每次pipeline携带数据量</li>
<li>pipeline每次只能作用在一个Redis节点上</li>
<li>M操作与pipeline区别</li>
</ol>
<h2 id="发布订阅"><a href="#发布订阅" class="headerlink" title="发布订阅"></a>发布订阅</h2><h3 id="角色"><a href="#角色" class="headerlink" title="角色"></a>角色</h3><ul>
<li>发布者（publisher）</li>
<li>订阅者（subscriber）</li>
<li>频道（channel）</li>
</ul>
<h3 id="模型"><a href="#模型" class="headerlink" title="模型"></a>模型</h3><p>Redis server中有各个频道。</p>
<p>发布者向频道中发布消息</p>
<p>订阅者收到其所订阅频道的消息，只能收到订阅时刻之后的消息，之前的收不到。</p>
<p><img src="https://upload-images.jianshu.io/upload_images/7432257-f91184b81f782b4f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1000/format/webp" alt=""></p>
<p>需要注意的是，redis没有消息堆积的能力。</p>
<h3 id="API-2"><a href="#API-2" class="headerlink" title="API"></a>API</h3><h4 id="publish"><a href="#publish" class="headerlink" title="publish"></a>publish</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">publish channel message</span><br></pre></td></tr></table></figure>
<p>eg:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">redis&gt;</span><span class="bash"> publish sohu:tv <span class="string">"hello world"</span></span></span><br><span class="line">(integer) 3 # 订阅者个数</span><br></pre></td></tr></table></figure>
<h4 id="subscribe"><a href="#subscribe" class="headerlink" title="subscribe"></a>subscribe</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">subscribe [channel] # 一个或多个</span><br></pre></td></tr></table></figure>
<h4 id="unsubscribe"><a href="#unsubscribe" class="headerlink" title="unsubscribe"></a>unsubscribe</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">unsubcribe [channle] # 一个或多个</span><br></pre></td></tr></table></figure>
<h4 id="其他-1"><a href="#其他-1" class="headerlink" title="其他"></a>其他</h4> <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 1. 订阅模式</span></span><br><span class="line">psubscribe [pattern]</span><br><span class="line"><span class="meta">#</span><span class="bash"> 2. 推定指定的模式</span></span><br><span class="line">punsubscribe [pattern]</span><br><span class="line"><span class="meta">#</span><span class="bash"> 3. 列出至少有一个订阅者的频道</span></span><br><span class="line">pubsub channels</span><br><span class="line"><span class="meta">#</span><span class="bash"> 4. 列出给定频道的订阅者数量</span></span><br><span class="line">pubsub numsub [channel]</span><br><span class="line"><span class="meta">#</span><span class="bash"> 5. 列出被订阅模式的数量</span></span><br><span class="line">pubsub numpat</span><br></pre></td></tr></table></figure>
<h3 id="发布订阅与消息队列"><a href="#发布订阅与消息队列" class="headerlink" title="发布订阅与消息队列"></a>发布订阅与消息队列</h3><p>发布订阅是所有订阅者可以收到所有的消息</p>
<p>消息队列是订阅者要进行消息抢夺，一条消息只有一个订阅者能够抢到。</p>
<h2 id="Bitmap"><a href="#Bitmap" class="headerlink" title="Bitmap"></a>Bitmap</h2><h3 id="位图"><a href="#位图" class="headerlink" title="位图"></a>位图</h3><table>
<thead>
<tr>
<th>b</th>
<th>i</th>
<th>g</th>
</tr>
</thead>
<tbody>
<tr>
<td>01100010</td>
<td>01101001</td>
<td>01100111</td>
</tr>
</tbody>
</table>
<h3 id="相关命令"><a href="#相关命令" class="headerlink" title="相关命令"></a>相关命令</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 1. 给位图指定索引设置值</span></span><br><span class="line">setbit key offset value</span><br><span class="line"><span class="meta">#</span><span class="bash"> 2. 获取位图指定索引的值</span></span><br><span class="line">getbit key offset</span><br><span class="line"><span class="meta">#</span><span class="bash"> 3. 获取位图指定范围（start到end，单位为字节，如果不指定就是获取全部）位值为1的个数</span></span><br><span class="line">bitcount key [start end]</span><br><span class="line"><span class="meta">#</span><span class="bash"> 4. 做多个Bitmap的and（交集）、or（并集）、not（非）、xor（抑或）操作并将结果保存在destkey中</span></span><br><span class="line">bitop op destkey key [key...]</span><br><span class="line"><span class="meta">#</span><span class="bash"> 5. 计算位图指定范围（start到end，单位为字节，如果不指定就是取全部）第一个偏移量对应的值等于targetBit的位置</span></span><br><span class="line">bitpos key targetBit [start][end]</span><br></pre></td></tr></table></figure>
<h3 id="独立用户统计"><a href="#独立用户统计" class="headerlink" title="独立用户统计"></a>独立用户统计</h3><ol>
<li>使用set和Bitmap</li>
<li>总共1亿用户，每日5千万独立访问。</li>
</ol>
<table>
<thead>
<tr>
<th>数据类型</th>
<th>每个userid只用空间</th>
<th>需要存储的用户量</th>
<th>全部内存量</th>
</tr>
</thead>
<tbody>
<tr>
<td>set</td>
<td>32位<br>（假设userid用的是整型，<br>实际很多网站用的是长整型）</td>
<td>50，000，000</td>
<td>32位*50，000，000=100MB</td>
</tr>
<tr>
<td>Bitmap</td>
<td>1位</td>
<td>100，000，000</td>
<td>12.5MB</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th></th>
<th>一天</th>
<th>一个月</th>
<th>一年</th>
</tr>
</thead>
<tbody>
<tr>
<td>set</td>
<td>200M</td>
<td>6G</td>
<td>72G</td>
</tr>
<tr>
<td>Bitmap</td>
<td>12.5M</td>
<td>375M</td>
<td>4.5G</td>
</tr>
</tbody>
</table>
<p>如果只有10万对立用户：<br>| 数据类型 | 每个userid占用空间 | 需要存储的用户量 | 全部内存量             |<br>| ——– | —————— | —————- | ———————- |<br>| set      | 32位               | 1,000,000        | 32位<em>1,000,000=4MB     |<br>| Bitmap   | 1位                | 100,000,000      | 1位</em>100,000,000=12.5MB |</p>
<h3 id="使用经验"><a href="#使用经验" class="headerlink" title="使用经验"></a>使用经验</h3><ol>
<li>type=string，最大512MB</li>
<li>注意setbit时的偏移量，可能有较大耗时</li>
<li>位图不是绝对好。</li>
</ol>
<h2 id="HyperLogLog"><a href="#HyperLogLog" class="headerlink" title="HyperLogLog"></a>HyperLogLog</h2><h2 id="GEO"><a href="#GEO" class="headerlink" title="GEO"></a>GEO</h2>
          
        
      
    </div>

    

    
    
    

    

    
       
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  
  <div>
	
  </div>
  </article>


    
  </section>

  


          </div>
          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/images/avatar.jpg" alt="Gzhennaxia">
            
              <p class="site-author-name" itemprop="name">Gzhennaxia</p>
              <p class="site-description motion-element" itemprop="description">我和我骄傲的倔强</p>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">5</span>
                    <span class="site-state-item-name">posts</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">6</span>
                    <span class="site-state-item-name">categories</span>
                  
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  <a href="/tags/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">7</span>
                    <span class="site-state-item-name">tags</span>
                  </a>
                </div>
              
            </nav>
          

          

          
            <div class="links-of-author motion-element">
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="https://github.com/yourname" title="GitHub &rarr; https://github.com/yourname" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
                </span>
              
            </div>
          

          

          
          

          
            
          
          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Gzhennaxia</span>

  

  
</div>


  <div class="powered-by">Powered by <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> v3.8.0</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Mist</a> v6.6.0</div>




        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
          <span id="scrollpercent"><span>0</span>%</span>
        
      </div>
    

    
	
    

    
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=6.6.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=6.6.0"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=6.6.0"></script>



  



  








  <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
  
  
  <script src="//unpkg.com/valine/dist/Valine.min.js"></script>
  
  <script type="text/javascript">
    var GUEST = ['nick','mail','link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(function (item) {
      return GUEST.indexOf(item)>-1;
    });
    new Valine({
        el: '#comments' ,
        verify: false,
        notify: false,
        appId: 'eVUj7cd3MyiEwfcYhXhBLmnh-gzGzoHsz',
        appKey: 'IfKchdp9FY0HDE1drNF3FDln',
        placeholder: 'Just Bi Bi',
        avatar:'mm',
        meta:guest,
        pageSize:'10' || 10,
        visitor: false
    });
  </script>



  





  

  

  

  

  

  
  

  

  

  

  

  

  

  
  <!-- 代码块复制功能 -->
  <script type="text/javascript" src="/js/src/clipboard.min.js"></script>  
  <script type="text/javascript" src="/js/src/clipboard-use.js"></script>
<script src="/live2dw/lib/L2Dwidget.min.js?0c58a1486de42ac6cc1c59c7d98ae887"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/shizuku.model.json"},"display":{"position":"right","width":150,"height":200},"mobile":{"show":true},"log":false});</script></body>
</html>
